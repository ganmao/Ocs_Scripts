#!/usr/bin/awk -f
BEGIN{
    FS="|"
    OFS="|"
}
{
    #print "NF="NF;
    if (NF > 33){
        #print $0
        expColNum = NF - 33
        #print "expColNum="expColNum
        #print "FILENAME="FILENAME
        if (expColNum == "1"){
            $21 = $21";"$22
            print $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34 > "./new/"FILENAME
        }else if (expColNum == "2"){
            $21 = $21";"$22";"$23
            print $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35 > "./new/"FILENAME
        }else if (expColNum == "3"){
            $21 = $21";"$22";"$23";"$24
            print $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35,$36 > "./new/"FILENAME
        }else if (expColNum == "4"){
            $21 = $21";"$22";"$23";"$24";"$25
            print $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35,$36,$37 > "./new/"FILENAME
        }else{
            print "split col over 4, plase connect zhang.dongliang"
        }
    }else{ print $0 > "./new/"FILENAME}
}
END{
    #print "NR="NR
}